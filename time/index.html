<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>时间间隔计算器 - icepig.top</title>
  
  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- Lunar.js 农历转换库 -->
  <script src="https://cdn.bootcdn.net/ajax/libs/lunar-javascript/1.6.13/lunar.js"></script>
  
  <!-- Configure Tailwind with Silver-Gray Tech Theme -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            // Silver-Gray Tech Color Palette - Light Theme
            'tech-silver': '#F9FAFB',
            'tech-gray': '#6B7280',
            'tech-dark': '#374151',
            'tech-darker': '#1F2937',
            'tech-blue': '#3B82F6',
            'tech-cyan': '#06B6D4',
            'tech-accent': '#8B5CF6',
            'tech-success': '#10B981',
            'tech-warning': '#F59E0B',
            // Dark theme colors
            'dark-bg': '#111827',
            'dark-card': '#1F2937',
            'dark-text': '#F9FAFB',
          },
          fontFamily: {
            'inter': ['Inter', 'system-ui', 'sans-serif'],
          },
          animation: {
            'grain': 'grain 8s steps(10) infinite',
            'float': 'float 6s ease-in-out infinite',
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'countdown': 'countdown 1s ease-in-out infinite',
            'fade-in': 'fadeIn 0.5s ease-in-out',
            'slide-up': 'slideUp 0.5s ease-in-out',
          },
          keyframes: {
            grain: {
              '0%, 100%': { transform: 'translate(0, 0)' },
              '10%': { transform: 'translate(-5%, -10%)' },
              '20%': { transform: 'translate(-15%, 5%)' },
              '30%': { transform: 'translate(7%, -25%)' },
              '40%': { transform: 'translate(-5%, 25%)' },
              '50%': { transform: 'translate(-15%, 10%)' },
              '60%': { transform: 'translate(15%, 0%)' },
              '70%': { transform: 'translate(0%, 15%)' },
              '80%': { transform: 'translate(3%, 35%)' },
              '90%': { transform: 'translate(-10%, 10%)' },
            },
            float: {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            countdown: {
              '0%': { transform: 'scale(1)' },
              '50%': { transform: 'scale(1.05)' },
              '100%': { transform: 'scale(1)' },
            },
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
            slideUp: {
              '0%': { transform: 'translateY(20px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' },
            },
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      /* Grain Gradient Background Effect */
      .grain-gradient {
        background: linear-gradient(135deg, 
          rgba(229, 231, 235, 0.1) 0%, 
          rgba(156, 163, 175, 0.1) 25%, 
          rgba(55, 65, 81, 0.1) 50%, 
          rgba(31, 41, 55, 0.1) 75%, 
          rgba(17, 24, 39, 0.1) 100%);
        position: relative;
        overflow: hidden;
      }
      
      .grain-gradient::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: 
          radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 40% 80%, rgba(120, 219, 255, 0.1) 0%, transparent 50%);
        animation: grain 8s steps(10) infinite;
        pointer-events: none;
      }
      
      .grain-gradient::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: repeating-linear-gradient(
          0deg,
          transparent,
          transparent 1px,
          rgba(255, 255, 255, 0.03) 1px,
          rgba(255, 255, 255, 0.03) 2px
        );
        animation: grain 8s steps(10) infinite;
        pointer-events: none;
      }
      
      /* Card hover effects */
      .tech-card {
        @apply bg-white/80 dark:bg-dark-card backdrop-blur-sm border border-tech-silver/30 dark:border-gray-700/50 rounded-2xl shadow-lg transition-all duration-500 hover:shadow-2xl hover:-translate-y-2;
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(249, 250, 251, 0.8));
      }
      
      .tech-card:hover {
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(249, 250, 251, 0.9));
        border-color: rgba(59, 130, 246, 0.3);
      }
      
      /* Navigation glass effect */
      .glass-nav {
        @apply bg-white/80 dark:bg-dark-card backdrop-blur-lg border-b border-tech-silver/20 dark:border-gray-700/20;
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(249, 250, 251, 0.7));
      }
      
      /* Hero text effects */
      .hero-text {
        @apply bg-gradient-to-r from-tech-dark via-tech-blue to-tech-cyan bg-clip-text text-transparent;
        background-size: 200% 200%;
        animation: gradient-shift 3s ease infinite;
      }
      
      @keyframes gradient-shift {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
      }
      
      /* Floating elements */
      .float-element {
        animation: float 6s ease-in-out infinite;
      }
      
      .float-element:nth-child(2) {
        animation-delay: -2s;
      }
      
      .float-element:nth-child(3) {
        animation-delay: -4s;
      }
      
      /* Tech grid pattern */
      .tech-grid {
        background-image: 
          linear-gradient(rgba(59, 130, 246, 0.1) 1px, transparent 1px),
          linear-gradient(90deg, rgba(59, 130, 246, 0.1) 1px, transparent 1px);
        background-size: 50px 50px;
      }
      
      /* Countdown styles */
      .countdown-number {
        @apply text-4xl md:text-6xl font-bold text-tech-blue;
      }
      
      .countdown-label {
        @apply text-sm md:text-base text-tech-gray mt-1;
      }
      
      .countdown-item {
        @apply flex flex-col items-center justify-center p-4 rounded-lg bg-white dark:bg-dark-card shadow-lg transition-all duration-300 hover:shadow-xl;
      }
      
      .btn-primary {
        @apply bg-gradient-to-r from-tech-blue to-tech-cyan hover:from-tech-blue/90 hover:to-tech-cyan/90 text-white font-medium py-3 px-6 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-tech-blue focus:ring-opacity-50;
      }
      
      .btn-secondary {
        @apply bg-white dark:bg-dark-card hover:bg-gray-100 dark:hover:bg-gray-700 text-tech-dark dark:text-dark-text font-medium py-3 px-6 rounded-lg border border-tech-silver dark:border-gray-600 transition-all duration-300 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-tech-blue focus:ring-opacity-50;
      }
      
      .input-field {
        @apply w-full px-4 py-3 border border-tech-silver rounded-lg focus:outline-none focus:ring-2 focus:ring-tech-blue focus:ring-opacity-50 focus:border-transparent;
      }
      
      /* Mobile responsive adjustments */
      @media (max-width: 768px) {
        .hero-text {
          font-size: clamp(2rem, 8vw, 3.5rem);
        }
        
        .tech-card {
          margin: 0 0.5rem;
        }
      }
    }
  </style>
</head>

<body class="font-inter bg-gray-50 dark:bg-dark-bg min-h-screen">
  <!-- Navigation -->
  <nav class="glass-nav sticky top-0 z-50">
    <div class="container mx-auto px-6 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-gradient-to-r from-tech-blue to-tech-cyan rounded-xl flex items-center justify-center">
            <i class="fa fa-clock-o text-white text-lg"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold text-tech-darker dark:text-dark-text">时间间隔计算器</h1>
            <p class="text-sm text-tech-gray dark:text-gray-400">icepig.top</p>
          </div>
        </div>
        <div class="hidden md:flex items-center space-x-6">
          <a href="/" class="text-tech-dark dark:text-dark-text hover:text-tech-blue dark:hover:text-tech-cyan transition-colors font-medium">首页</a>
          <a href="/ascii" class="text-tech-dark dark:text-dark-text hover:text-tech-blue dark:hover:text-tech-cyan transition-colors font-medium">ASCII工具</a>
          <a href="/bg/index.html" class="text-tech-dark dark:text-dark-text hover:text-tech-blue dark:hover:text-tech-cyan transition-colors font-medium">联系</a>
          <!-- Theme Toggle -->
          <button id="theme-toggle" class="p-2 rounded-lg bg-tech-silver hover:bg-tech-gray transition-colors duration-200">
            <svg id="theme-icon" class="w-5 h-5 text-tech-dark dark:text-dark-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
          </button>
        </div>
        <div class="md:hidden flex items-center space-x-2">
          <!-- Mobile Theme Toggle -->
          <button id="mobile-theme-toggle" class="p-2 rounded-lg bg-tech-silver hover:bg-tech-gray transition-colors duration-200">
            <svg id="mobile-theme-icon" class="w-5 h-5 text-tech-dark dark:text-dark-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
          </button>
          <button id="mobile-menu-btn" class="text-tech-dark p-2 rounded-lg hover:bg-gray-100 transition-colors">
            <i class="fa fa-bars text-xl"></i>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="md:hidden bg-white border-t border-tech-silver/30 shadow-lg hidden">
      <div class="px-6 py-4 space-y-4">
        <a href="/" class="block text-tech-dark dark:text-dark-text hover:text-tech-blue dark:hover:text-tech-cyan transition-colors font-medium py-2">首页</a>
        <a href="/ascii" class="block text-tech-dark dark:text-dark-text hover:text-tech-blue dark:hover:text-tech-cyan transition-colors font-medium py-2">ASCII工具</a>
        <a href="/bg/index.html" class="block text-tech-dark dark:text-dark-text hover:text-tech-blue dark:hover:text-tech-cyan transition-colors font-medium py-2">联系</a>
        <div class="flex items-center space-x-2 py-2">
          <span class="text-tech-gray dark:text-gray-400">主题:</span>
          <button id="mobile-theme-toggle-menu" class="px-3 py-1 bg-tech-silver hover:bg-tech-gray rounded text-sm transition-colors duration-200">
            切换主题
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="relative min-h-screen grain-gradient tech-grid flex items-center justify-center overflow-hidden">
    <!-- Floating geometric elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <div class="float-element absolute top-20 left-10 w-20 h-20 bg-tech-blue/20 rounded-full blur-xl"></div>
      <div class="float-element absolute top-40 right-20 w-32 h-32 bg-tech-cyan/20 rounded-full blur-xl"></div>
      <div class="float-element absolute bottom-20 left-1/4 w-24 h-24 bg-tech-accent/20 rounded-full blur-xl"></div>
      <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-r from-tech-blue/10 to-tech-cyan/10 rounded-full blur-3xl"></div>
    </div>
    
    <div class="container mx-auto px-6 text-center relative z-10">
      <div class="max-w-4xl mx-auto">
        <!-- Hero Badge -->
        <div class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full border border-tech-silver/30 mb-8">
          <i class="fa fa-calendar text-tech-blue mr-2"></i>
          <span class="text-tech-dark dark:text-dark-text font-medium">精确时间计算</span>
        </div>
        
        <!-- Main Hero Text -->
        <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-tight">
          <span class="hero-text">时间间隔</span><br>
          <span class="text-tech-darker dark:text-dark-text">计算器</span>
        </h1>
        
        <!-- Hero Subtitle -->
        <p class="text-xl md:text-2xl text-tech-gray mb-8 max-w-3xl mx-auto leading-relaxed">
          计算距离目标时间的精确间隔，支持农历显示和自定义目标时间设置。
        </p>
        
        <!-- Hero CTA Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-12">
          <a href="#calculator" class="group px-8 py-4 bg-gradient-to-r from-tech-blue to-tech-cyan text-white rounded-xl font-semibold transition-all duration-300 hover:shadow-lg hover:-translate-y-1 flex items-center">
            <span>开始计算</span>
            <i class="fa fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
          </a>
          <a href="#features" class="px-8 py-4 bg-white/80 backdrop-blur-sm text-tech-dark border border-tech-silver/30 rounded-xl font-semibold transition-all duration-300 hover:bg-white hover:shadow-lg hover:-translate-y-1">
            功能特色
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Calculator Section -->
  <section id="calculator" class="py-20 bg-white relative">
    <div class="container mx-auto px-6">
      <!-- 当前时间和农历显示 -->
      <div class="tech-card p-8 mb-8">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <div class="mb-4 md:mb-0">
            <p class="text-lg text-tech-gray">当前时间</p>
            <p id="current-time" class="text-3xl font-bold text-tech-dark">2025-10-29 21:13:32</p>
          </div>
          <div class="flex items-center space-x-4">
            <div class="w-12 h-12 bg-gradient-to-r from-tech-blue to-tech-cyan rounded-xl flex items-center justify-center">
              <i class="fa fa-calendar text-white text-xl"></i>
            </div>
            <div>
              <p class="text-lg text-tech-gray">农历</p>
              <p id="lunar-date" class="text-2xl font-semibold text-tech-dark">乙巳年九月十四</p>
            </div>
          </div>
        </div>
      </div>

      <!-- 倒计时显示区域 -->
      <div class="tech-card p-8 mb-8">
        <div class="text-center mb-6">
          <h2 class="text-2xl font-bold text-tech-darker dark:text-dark-text mb-2">距离目标时间</h2>
          <p id="target-time-display" class="text-lg text-tech-gray">2026年除夕 20:00:00</p>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 md:gap-6">
          <div class="countdown-item">
            <span id="years" class="countdown-number">0</span>
            <span class="countdown-label">年</span>
          </div>
          <div class="countdown-item">
            <span id="months" class="countdown-number">0</span>
            <span class="countdown-label">月</span>
          </div>
          <div class="countdown-item">
            <span id="days" class="countdown-number">0</span>
            <span class="countdown-label">日</span>
          </div>
          <div class="countdown-item">
            <span id="hours" class="countdown-number">0</span>
            <span class="countdown-label">时</span>
          </div>
          <div class="countdown-item">
            <span id="minutes" class="countdown-number">0</span>
            <span class="countdown-label">分</span>
          </div>
          <div class="countdown-item">
            <span id="seconds" class="countdown-number">0</span>
            <span class="countdown-label">秒</span>
          </div>
        </div>
      </div>

      <!-- 控制面板 -->
      <div class="tech-card p-8">
        <h2 class="text-2xl font-bold text-tech-darker dark:text-dark-text mb-6 text-center">控制面板</h2>
        
        <div class="flex flex-col md:flex-row justify-center items-center gap-6">
          <!-- 目标时间选择 -->
          <div class="w-full md:w-auto">
            <label for="target-date" class="block text-sm font-medium text-tech-dark dark:text-dark-text mb-2">选择目标日期</label>
            <input type="date" id="target-date" class="input-field">
          </div>
          
          <div class="w-full md:w-auto">
            <label for="target-time" class="block text-sm font-medium text-tech-dark dark:text-dark-text mb-2">选择目标时间</label>
            <input type="time" id="target-time" class="input-field">
          </div>
          
          <div class="flex flex-col gap-3 w-full md:w-auto">
            <button id="set-target-btn" class="btn-primary flex items-center justify-center">
              <i class="fa fa-check mr-2"></i> 设置目标时间
            </button>
            <button id="reset-to-new-year-btn" class="btn-secondary flex items-center justify-center">
              <i class="fa fa-refresh mr-2"></i> 重置为除夕
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section id="features" class="py-20 grain-gradient">
    <div class="container mx-auto px-6">
      <div class="text-center mb-16">
        <div class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full border border-tech-silver/30 mb-8">
          <i class="fa fa-star text-tech-blue mr-2"></i>
          <span class="text-tech-dark dark:text-dark-text font-medium">功能特色</span>
        </div>
        
        <h2 class="text-4xl md:text-5xl font-bold text-tech-darker dark:text-dark-text mb-6">
          强大的<span class="hero-text">计算能力</span>
        </h2>
        
        <p class="text-xl text-tech-gray max-w-3xl mx-auto">
          精确的时间间隔计算，支持农历显示和自定义目标时间设置
        </p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="text-center">
          <div class="w-16 h-16 bg-gradient-to-r from-tech-blue to-tech-cyan rounded-2xl flex items-center justify-center mx-auto mb-6">
            <i class="fa fa-clock-o text-white text-2xl"></i>
          </div>
          <h3 class="text-xl font-bold text-tech-darker mb-4">精确计算</h3>
          <p class="text-tech-gray">精确到秒的时间间隔计算，实时更新</p>
        </div>
        
        <div class="text-center">
          <div class="w-16 h-16 bg-gradient-to-r from-tech-cyan to-tech-success rounded-2xl flex items-center justify-center mx-auto mb-6">
            <i class="fa fa-calendar text-white text-2xl"></i>
          </div>
          <h3 class="text-xl font-bold text-tech-darker mb-4">农历支持</h3>
          <p class="text-tech-gray">显示农历日期，支持传统节日计算</p>
        </div>
        
        <div class="text-center">
          <div class="w-16 h-16 bg-gradient-to-r from-tech-accent to-tech-warning rounded-2xl flex items-center justify-center mx-auto mb-6">
            <i class="fa fa-cogs text-white text-2xl"></i>
          </div>
          <h3 class="text-xl font-bold text-tech-darker mb-4">自定义设置</h3>
          <p class="text-tech-gray">支持自定义目标时间和快速重置功能</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-tech-darker text-white py-16">
    <div class="container mx-auto px-6">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <!-- Brand -->
        <div class="md:col-span-2">
          <div class="flex items-center space-x-3 mb-6">
            <div class="w-10 h-10 bg-gradient-to-r from-tech-blue to-tech-cyan rounded-xl flex items-center justify-center">
              <i class="fa fa-clock-o text-white text-lg"></i>
            </div>
            <div>
              <h3 class="text-xl font-bold">时间间隔计算器</h3>
              <p class="text-tech-gray">icepig.top</p>
            </div>
          </div>
          <p class="text-tech-gray mb-6 max-w-md">
            精确的时间间隔计算工具，支持农历显示和自定义目标时间。
          </p>
          <div class="flex space-x-4">
            <a href="https://github.com/purezra" class="w-10 h-10 bg-tech-dark rounded-lg flex items-center justify-center hover:bg-tech-blue transition-colors">
              <i class="fa fa-github"></i>
            </a>
          </div>
        </div>
        
        <!-- Quick Links -->
        <div>
          <h4 class="text-lg font-semibold mb-4">快速链接</h4>
          <ul class="space-y-2">
            <li><a href="/" class="text-tech-gray hover:text-white transition-colors">首页</a></li>
            <li><a href="/ascii" class="text-tech-gray hover:text-white transition-colors">ASCII工具</a></li>
            <li><a href="/bg/index.html" class="text-tech-gray hover:text-white transition-colors">联系</a></li>
          </ul>
        </div>
        
        <!-- Features -->
        <div>
          <h4 class="text-lg font-semibold mb-4">功能</h4>
          <ul class="space-y-2">
            <li><span class="text-tech-gray dark:text-gray-400">精确时间计算</span></li>
            <li><span class="text-tech-gray">农历显示</span></li>
            <li><span class="text-tech-gray">自定义目标时间</span></li>
            <li><span class="text-tech-gray">实时更新</span></li>
          </ul>
        </div>
      </div>
      
      <div class="border-t border-tech-dark mt-12 pt-8 text-center">
        <p class="text-tech-gray">
          © 2025 icepig.top 时间间隔计算器. 精确的时间计算工具。
        </p>
      </div>
    </div>
  </footer>

  <script>
    // 全局变量
    let targetDate = null;
    let countdownInterval = null;

    // DOM 元素
    const currentTimeEl = document.getElementById('current-time');
    const lunarDateEl = document.getElementById('lunar-date');
    const targetTimeDisplayEl = document.getElementById('target-time-display');
    const yearsEl = document.getElementById('years');
    const monthsEl = document.getElementById('months');
    const daysEl = document.getElementById('days');
    const hoursEl = document.getElementById('hours');
    const minutesEl = document.getElementById('minutes');
    const secondsEl = document.getElementById('seconds');
    const targetDateInput = document.getElementById('target-date');
    const targetTimeInput = document.getElementById('target-time');
    const setTargetBtn = document.getElementById('set-target-btn');
    const resetToNewYearBtn = document.getElementById('reset-to-new-year-btn');

    // 初始化函数
    function init() {
      setDefaultTargetDate();
      updateCurrentTime();
      startCountdown();
      setTargetBtn.addEventListener('click', handleSetTargetTime);
      resetToNewYearBtn.addEventListener('click', handleResetToNewYear);
      setupMobileMenu();
      
      setInterval(() => {
        updateCurrentTime();
        updateCountdown();
      }, 1000);
    }

    // 设置移动端菜单
    function setupMobileMenu() {
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      const menuIcon = mobileMenuBtn.querySelector('i');
      
      mobileMenuBtn.addEventListener('click', () => {
        const isHidden = mobileMenu.classList.contains('hidden');
        
        if (isHidden) {
          mobileMenu.classList.remove('hidden');
          menuIcon.classList.remove('fa-bars');
          menuIcon.classList.add('fa-times');
        } else {
          mobileMenu.classList.add('hidden');
          menuIcon.classList.remove('fa-times');
          menuIcon.classList.add('fa-bars');
        }
      });
      
      const mobileMenuLinks = mobileMenu.querySelectorAll('a');
      mobileMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.add('hidden');
          menuIcon.classList.remove('fa-times');
          menuIcon.classList.add('fa-bars');
        });
      });
    }

    // 设置默认目标时间为下一个除夕
    function setDefaultTargetDate() {
      const now = new Date();
      let year = now.getFullYear();
      
      let newYearEve = getNewYearEve(year);
      
      if (newYearEve < now) {
        newYearEve = getNewYearEve(year + 1);
      }
      
      newYearEve.setHours(20, 0, 0, 0);
      
      targetDate = newYearEve;
      updateTargetTimeDisplay();
      updateDateAndTimeInputs();
    }

    // 获取指定年份的除夕日期
    function getNewYearEve(year) {
      try {
        const solar = Solar.fromYmd(year, 1, 1);
        const lunar = solar.getLunar();
        const nextLunarYear = lunar.getYear() + 1;
        
        let lunarNewYear = null;
        let month = 1;
        let day = 1;
        
        while (month <= 2) {
          const date = Solar.fromYmd(year, month, day);
          const lunarDate = date.getLunar();
          
          if (lunarDate.getYear() === nextLunarYear && lunarDate.getMonth() === 1 && lunarDate.getDay() === 1) {
            lunarNewYear = date.getDate();
            break;
          }
          
          day++;
          if (day > 29) {
            day = 1;
            month++;
          }
        }
        
        if (lunarNewYear) {
          const newYearEve = new Date(lunarNewYear);
          newYearEve.setDate(newYearEve.getDate() - 1);
          return newYearEve;
        }
      } catch (e) {
        console.error('计算除夕日期出错:', e);
      }
      
      return new Date(year, 0, 21);
    }

    // 更新当前时间和农历
    function updateCurrentTime() {
      const now = new Date();
      
      currentTimeEl.textContent = formatDateTime(now);
      
      try {
        const solar = Solar.fromDate(now);
        const lunar = solar.getLunar();
        const lunarMonth = lunar.getMonthInChinese().replace(/\s+/g, '');
        const lunarDay = lunar.getDayInChinese().replace(/\s+/g, '');
        lunarDateEl.textContent = `${lunar.getYearInGanZhi()}年${lunarMonth}月${lunarDay}`;
      } catch (e) {
        console.error('农历转换出错:', e);
        lunarDateEl.textContent = '农历数据加载中...';
      }
    }

    // 格式化日期时间
    function formatDateTime(date) {
      const year = date.getFullYear();
      const month = padZero(date.getMonth() + 1);
      const day = padZero(date.getDate());
      const hours = padZero(date.getHours());
      const minutes = padZero(date.getMinutes());
      const seconds = padZero(date.getSeconds());
      
      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
    }

    // 数字补零
    function padZero(num) {
      return num < 10 ? `0${num}` : num;
    }

    // 更新目标时间显示
    function updateTargetTimeDisplay() {
      if (!targetDate) return;
      
      try {
        const solar = Solar.fromDate(targetDate);
        const lunar = solar.getLunar();
        let displayText = '';
        
        if (lunar.getMonth() === 12 && (lunar.getDay() === 29 || lunar.getDay() === 30)) {
          displayText = `${targetDate.getFullYear()}年除夕 ${formatTime(targetDate)}`;
        } else {
          displayText = `${formatDate(targetDate)} ${formatTime(targetDate)}`;
        }
        
        targetTimeDisplayEl.textContent = displayText;
      } catch (e) {
        targetTimeDisplayEl.textContent = `${formatDate(targetDate)} ${formatTime(targetDate)}`;
      }
    }

    // 格式化日期
    function formatDate(date) {
      const year = date.getFullYear();
      const month = padZero(date.getMonth() + 1);
      const day = padZero(date.getDate());
      
      return `${year}-${month}-${day}`;
    }

    // 格式化时间
    function formatTime(date) {
      const hours = padZero(date.getHours());
      const minutes = padZero(date.getMinutes());
      const seconds = padZero(date.getSeconds());
      
      return `${hours}:${minutes}:${seconds}`;
    }

    // 更新日期和时间输入框
    function updateDateAndTimeInputs() {
      if (!targetDate) return;
      
      targetDateInput.value = formatDate(targetDate);
      targetTimeInput.value = formatTime(targetDate).substring(0, 5);
    }

    // 开始倒计时
    function startCountdown() {
      if (countdownInterval) {
        clearInterval(countdownInterval);
      }
      
      updateCountdown();
      
      countdownInterval = setInterval(() => {
        updateCountdown();
      }, 1000);
    }

    // 更新倒计时
    function updateCountdown() {
      if (!targetDate) return;
      
      const now = new Date();
      const diff = targetDate - now;
      
      if (diff <= 0) {
        updateCountdownDisplay(0, 0, 0, 0, 0, 0);
        return;
      }
      
      const { years, months, days, hours, minutes, seconds } = calculateTimeDifference(now, targetDate);
      updateCountdownDisplay(years, months, days, hours, minutes, seconds);
    }

    // 计算时间差
    function calculateTimeDifference(startDate, endDate) {
      const diffMs = endDate - startDate;
      const totalSeconds = Math.floor(diffMs / 1000);
      
      const seconds = totalSeconds % 60;
      const totalMinutes = Math.floor(totalSeconds / 60);
      const minutes = totalMinutes % 60;
      const totalHours = Math.floor(totalMinutes / 60);
      const hours = totalHours % 24;
      const totalDays = Math.floor(totalHours / 24);
      
      let years = 0;
      let months = 0;
      let days = totalDays;
      
      years = Math.floor(days / 365);
      days %= 365;
      
      months = Math.floor(days / 30);
      days %= 30;
      
      return { years, months, days, hours, minutes, seconds };
    }

    // 更新倒计时显示
    function updateCountdownDisplay(years, months, days, hours, minutes, seconds) {
      yearsEl.textContent = years;
      monthsEl.textContent = months;
      daysEl.textContent = days;
      hoursEl.textContent = hours;
      minutesEl.textContent = minutes;
      secondsEl.textContent = seconds;
      
      [yearsEl, monthsEl, daysEl, hoursEl, minutesEl, secondsEl].forEach(el => {
        el.classList.add('animate-countdown');
        setTimeout(() => {
          el.classList.remove('animate-countdown');
        }, 500);
      });
    }

    // 处理设置目标时间按钮点击
    function handleSetTargetTime() {
      const dateStr = targetDateInput.value;
      const timeStr = targetTimeInput.value || '00:00';
      
      if (!dateStr) {
        alert('请选择目标日期');
        return;
      }
      
      const [year, month, day] = dateStr.split('-').map(Number);
      const [hours, minutes] = timeStr.split(':').map(Number);
      
      const newTargetDate = new Date(year, month - 1, day, hours, minutes, 0, 0);
      
      if (isNaN(newTargetDate.getTime())) {
        alert('无效的日期或时间');
        return;
      }
      
      targetDate = newTargetDate;
      updateTargetTimeDisplay();
      startCountdown();
    }

    // 处理重置为除夕按钮点击
    function handleResetToNewYear() {
      setDefaultTargetDate();
      startCountdown();
    }

    // Theme Management
    function initTheme() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      const theme = savedTheme;
      
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
        updateThemeIcons('dark');
      } else {
        document.documentElement.classList.remove('dark');
        updateThemeIcons('light');
      }
    }

    function updateThemeIcons(theme) {
      const icons = ['theme-icon', 'mobile-theme-icon'];
      icons.forEach(iconId => {
        const icon = document.getElementById(iconId);
        if (icon) {
          if (theme === 'dark') {
            icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>';
          } else {
            icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>';
          }
        }
      });
    }

    function toggleTheme() {
      const isDark = document.documentElement.classList.contains('dark');
      const newTheme = isDark ? 'light' : 'dark';
      
      if (newTheme === 'dark') {
        document.documentElement.classList.add('dark');
        updateThemeIcons('dark');
      } else {
        document.documentElement.classList.remove('dark');
        updateThemeIcons('light');
      }
      
      localStorage.setItem('theme', newTheme);
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', () => {
      initTheme();
      init();
      
      // Theme toggle buttons
      const themeToggle = document.getElementById('theme-toggle');
      const mobileThemeToggle = document.getElementById('mobile-theme-toggle');
      const mobileThemeToggleMenu = document.getElementById('mobile-theme-toggle-menu');

      if (themeToggle) {
        themeToggle.addEventListener('click', toggleTheme);
      }
      if (mobileThemeToggle) {
        mobileThemeToggle.addEventListener('click', toggleTheme);
      }
      if (mobileThemeToggleMenu) {
        mobileThemeToggleMenu.addEventListener('click', toggleTheme);
      }
    });
  </script>
</body>
</html>